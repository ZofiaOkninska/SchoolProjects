<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>Bubbles</title>
  <style>
    * {
      margin: auto;
    }

    #board {
      margin-top: 50px;
      width: 468px;
    }

    .cell {
      width: 50px;
      height: 50px;
      border: 1px solid white;
      border-radius: 6px;
      background-color: lightgray;
      display: inline-block;
      margin-bottom: -3px;
    }

    .bubble {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin-top: 5px;
      margin-left: 5px;
    }
  </style>
</head>

<body>
  <div id="board"></div>

  <script>
    //#######################implementing#classes###############################

    //is Bubble class
    function Bubble(htmlElement, parentCellPositionX, parentCellPositionY) {
      this.htmlElement = htmlElement;
      this.parentCellPositionX = parentCellPositionX;
      this.parentCellPositionY = parentCellPositionY; //dunno if needed

      this.isSelected = false; //nie isSelected jeżeli isSurrounded

      // this.htmlElement.onclick = function() {
      //   if (!this.isSelected) {
      //     this.isSelected = true;
      //     sm();
      //   } else if (this.isSelected) {
      //     this.isSelected = false;
      //     om();
      //   }
      // }

      this.htmlElement.onclick = function() {
        if (!isSurrounded) { //isSurrounded: if all of this neighbours !isEmpty => return true;
          unselectAllCells();
          this.isSelected = true;
        }
      }
    }

    //#########bubble#onclick#functions##########

    function unselectAllCells() {
      //document.board.cells.forEach(this.isSelected = false);
    }

    function sm() {
      alert("ooo");
    }

    function om() {
      alert("mmm");
    }

    //######end#of#bubble#onclick#functions######

    //is Cell class
    function Cell(htmlElement, positionX, positionY) {
      this.htmlElement = htmlElement;
      this.positionX = positionX;
      this.positionY = positionY;

      this.bubble = null;
      this.isEmpty = true;

      //this.neighbours = function(this.positionX, this.positionY){
      //
      //}
    }

    //is Board class
    function Board(rowCount, boardDiv) {
      //creates 2-dimensional "cells" object-array (rows created "rowCount" times)
      //and objects's hmtlElement(of "cell" className, of "board" appendChild_destination)
      this.cells = createObjectsArray(Cell, rowCount, "cell", boardDiv);

      //table of bubble-objects on board
      this.bubbles = [];

      this.graph = new Graph(this.cells);
    }

    //creates 2-dimensional objects-array (rows created "count" times)
    //and objects's : hmtlElement(className, appendChild_destination), "positionX" property, "positionY" property
    function createObjectsArray(objectName, count, className, appendChild_destination) {
      var array = [count];
      for (var i = 0; i < count; i++) {
        array[i] = [count];
        for (var j = 0; j < count; j++) {
          array[i][j] = new objectName(addHtmlElement(className, appendChild_destination), i, j);
        }
      }
      return array;
    }

    //adds div-hmtlElement with css-class to specified destination
    function addHtmlElement(className, destination) {
      var div = document.createElement("div");
      div.classList.add(className);
      destination.appendChild(div);
      return div;
    };

    //#####################bubbles#adding#functionality#########################

    //adds three bubbles to next round of random position & color
    function addNextRoundBubbles(cellsArray, bubblesArray, colors) {
      for (var i = 0; i < 3; i++) {
        //get a random cell object
        var element = getRandomIndexFromArray(getEmptyCellsArray(cellsArray));

        //set bubble of a cell
        element.bubble = new Bubble(addHtmlElement("bubble", element.htmlElement), element.positionX, element.positionY);
        element.isEmpty = false;
        //add cell's bubble to bubbles array
        bubblesArray.push(element.bubble)

        //get random color and set it in bubble
        var color = getRandomIndexFromArray(colors);
        element.bubble.htmlElement.style.backgroundColor = color;
      }
    }

    //gets all empty cells form board
    function getEmptyCellsArray(cellsArray) {
      var emptyCells = [];
      for (var i = 0; i < cellsArray.length; i++) {
        for (var j = 0; j < cellsArray.length; j++)
          if (cellsArray[i][j].isEmpty) {
            emptyCells.push(cellsArray[i][j]);
          }
      }
      return emptyCells;
    }

    //returns random index form given array
    function getRandomIndexFromArray(array) {
      return array[Math.floor(Math.random() * array.length)];
    }

    //#########################graph#functionality##############################
    //sąsiad Nodea, to Node, którego współrzędne contentu to x-1,y itd
    //{key: value, key2: value}

    //is Graph class
    function Graph(cellsArray) {
      this.adjacencyList = createAdjacencyList(cellsArray);
    }

    //creates adjacencyList from Nodes
    function createAdjacencyList(cellsArray) {
      var adjacencyList = new Map();

      //add nodes
      for (var i = 0; i < cellsArray.length; i++) {
        for (var j = 0; j < cellsArray.length; j++) {
          adjacencyList.set(new Node(cellsArray[i][j].positionX, cellsArray[i][j].positionY), null);
        }
      }

      //add nodes neighbours
      for (var [key, value] of adjacencyList) {
        adjacencyList.set(key, getNodeNeighbours(key));
      }
      return adjacencyList;
    }

    //is Node class
    function Node(x, y) { //zapewne bez cell tylko same pos
      //this.cell = cell;
      this.x = x;
      this.y = y;
    }

    //returns array of nodes being neighbours of given node
    function getNodeNeighbours(key) {
      var neighbours = [];

      //top neighbour
      if (key.x != 0) {
        //key.x - 1
        //searchForANode();
        neighbours.push(); //node o key.x = x - 1
      }

      //bottom neighbour
      if (key.x != 8) {
        //key.x + 1
      }

      //left neighbour
      if (key.y != 0) {
        //key.y - 1
      }

      //right neighbour
      if (key.y != 8) {
        //key.y + 1
      }

      return neighbours;
    }

    //###############################initialize#################################

    function init() {
      //               roxzow     fiol         brazy    ziel       nieb
      var colors = ["#d27979", "#99336d", "#823E25", "#277552", "#2C4770", "#B84734", "#FFFF7A"];
      var board = new Board(9, document.getElementById("board"));

      //if (!beatedBubbles) {
      if (true) {
        addNextRoundBubbles(board.cells, board.bubbles, colors);
      }
      console.log(board)
    }

    init();
  </script>
</body>

</html>